<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Sprint: Provisioning</title>
<!-- 2017-05-31 Wed 08:12 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Mikael Svahnberg" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../org/org.css" />
<link rel="stylesheet" type="text/css" href="org/org.css" />
<link rel="stylesheet" type="text/css" href="/org/org.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Sprint: Provisioning</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. About This Sprint</a></li>
<li><a href="#sec-2">2. User Stories covered in this Sprint</a></li>
<li><a href="#sec-3">3. Introduction</a>
<ul>
<li><a href="#sec-3-1">3.1. Provisioning</a></li>
<li><a href="#sec-3-2">3.2. Deployment</a></li>
<li><a href="#sec-3-3">3.3. Tools</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Learning Material</a>
<ul>
<li><a href="#sec-4-1">4.1. Book Chapters</a></li>
<li><a href="#sec-4-2">4.2. Articles</a></li>
<li><a href="#sec-4-3">4.3. Further Reading</a></li>
</ul>
</li>
<li><a href="#sec-5">5. Experiential Learning</a>
<ul>
<li><a href="#sec-5-1">5.1. Provisioning with Vagrant</a>
<ul>
<li><a href="#sec-5-1-1">5.1.1. Prerequisites</a></li>
<li><a href="#sec-5-1-2">5.1.2. Tasks</a></li>
</ul>
</li>
<li><a href="#sec-5-2">5.2. Provisioning with Puppet</a>
<ul>
<li><a href="#sec-5-2-1">5.2.1. Prerequisites</a></li>
<li><a href="#sec-5-2-2">5.2.2. Tasks</a></li>
<li><a href="#sec-5-2-3">5.2.3. Cleanup</a></li>
</ul>
</li>
<li><a href="#sec-5-3">5.3. Update Sprint Test Plan</a></li>
<li><a href="#sec-5-4">5.4. Update Course Backlog</a></li>
</ul>
</li>
<li><a href="#sec-6">6. Sprint Acceptance Tests</a></li>
</ul>
</div>
</div>
<br/>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> About This Sprint</h2>
<div class="outline-text-2" id="text-1">
<p>
This sprint how to set up your virtual machine with the software you need in order to run your applications.
</p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> User Stories covered in this Sprint</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>As a developer I want a scripted solution for setting up a new server so that I do not forget any important steps.
</li>
<li>As a tester I want a scripted solution for setting up a test server to make sure that I have the same environment as the production servers.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Introduction</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Provisioning</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Before a virtual machine image is ready to run your application, you may need to install additional software on it. For example, you may need to install a database engine, a web server, node.js and npm, or any other tools. This is, in the terminology of Vagrant, called <i>provisioning</i>. There are several tools available to help you with this, and vagrant provides its own simple way of doing this too (which you will try out in this module).
</p>


<div class="figure">
<p><img src="./images/IProvisioning.png" alt="IProvisioning.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Deployment</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Deployment, which may be seen as a part of the provisioning is the process of taking your application, spreading it to your configuration of servers, and starting it. With Vagrant, you have two options to start with directly, if you do not go for any of the provisioning tools available. You can either use Vagrant&rsquo;s built-in provisioning facility to also download your application to your server and start it, or you can use the fact that the directory `/vagrant` is rsynced with your start directory. The latter means that your Vagrantfile is part of your actual build environment, which means that you only need one place to keep your files.
</p>


<div class="figure">
<p><img src="./images/IBuildDir.png" alt="IBuildDir.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Tools</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Several tools exist for this process, in addition to the simplistic support provided by Vagrant itself. Below is a brief list of some of the more common tools. These are often referred to as <b>Configuration Management Tools</b>, <b>Orchestration Tools</b>, or <b>Provisioning Tools</b>.
</p>

<ul class="org-ul">
<li><a href="http://www.ansible.com/home">Ansible</a>
</li>
<li><a href="https://www.chef.io/">Chef</a>
</li>
<li><a href="https://puppetlabs.com/">Puppet</a>
</li>
<li><a href="http://saltstack.com/">Salt</a>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Learning Material</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Book Chapters</h3>
<div class="outline-text-3" id="text-4-1">
<p>
J. Rosenberg, A. Mateos, &ldquo;The Cloud at your Service&rdquo;, Manning, 2010. chapters:
</p>
<ol class="org-ol">
<li value="4">Security and the Private Cloud
</li>
<li>Designing and Architecting for Cloud Scale
</li>
<li value="7">Testing, Deployment, and Operations in the Cloud
</li>
</ol>

<p>
G. Reese &ldquo;Cloud Application Architectures&rdquo;, O’Reilly, 2009. chapters:
</p>
<ol class="org-ol">
<li value="4">Ready for the Cloud
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Articles</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li><a href="https://www.vagrantup.com/docs/provisioning/index.html">Provisioning with Vagrant</a>
</li>
<li><a href="http://www.howardism.org/Technical/Emacs/literate-devops.html">Literate DevOps</a>
</li>
<li><a href="https://ttboj.wordpress.com/2013/12/21/vagrant-vsftp-and-other-tricks/">Vagrant vsftp and other tricks</a>
</li>
<li><a href="http://www.linux.com/news/software/applications/694157-setup-your-dev-environment-in-nothing-flat-with-puppet">Example tutorial by Max Martin on using Puppet and Vagrant</a> (The important stuff is on page 2).
</li>
<li><a href="https://github.com/patrickdlee/vagrant-examples">A series of Vagrant examples using Puppet with increasing complexity</a>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Further Reading</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li><a href="http://shawn.dahlen.me/blog/2013/04/12/manage-all-application-environments-with-vagrant/">Example tutorial by Shawn Dahlen on how to combine Vagrant and Chef</a>
</li>
<li><a href="http://docs.saltstack.com/en/latest/contents.html">Salt User Manual</a> Chapter 3 in particular contains tutorials.
</li>
<li>J. Arundel, &ldquo;Puppet 3: Beginner&rsquo;s Guide&rdquo;, Packt Publishing, 2013.
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Experiential Learning</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> Provisioning with Vagrant</h3>
<div class="outline-text-3" id="text-5-1">
</div><div id="outline-container-sec-5-1-1" class="outline-4">
<h4 id="sec-5-1-1"><span class="section-number-4">5.1.1</span> Prerequisites</h4>
<div class="outline-text-4" id="text-5-1-1">
<ul class="org-ul">
<li>You have installed and tested VirtualBox and Vagrant
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-5-1-2" class="outline-4">
<h4 id="sec-5-1-2"><span class="section-number-4">5.1.2</span> Tasks</h4>
<div class="outline-text-4" id="text-5-1-2">
<p>
In this example you are going to make sure that you have <code>git</code> and <code>node.js</code> installed and ready to use. In order to install <code>node.js</code>, you also need <code>curl</code>.
</p>

<ul class="org-ul">
<li>Edit your Vagrantfile so that it reads:
</li>
</ul>
<div class="org-src-container">

<pre class="src src-ruby">Vagrant.configure(2) do |config|
  config.vm.box = "hashicorp/precise64"

  config.vm.provision "shell", inline: &lt;&lt;-SHELL
sudo apt-get update
sudo apt-get install -y curl git
curl -sL https://deb.nodesource.com/setup_4.x | sudo -E bash -
sudo apt-get install -y nodejs
sudo apt-get install -y build-essential
  SHELL
end
</pre>
</div>

<p>
As you can see, your provisioning in this case is a simple execution of a shell script.
</p>

<ul class="org-ul">
<li>Now, start your box, ssh into it, and see what you have installed:
</li>
</ul>
<div class="org-src-container">

<pre class="src src-bash">$ vagrant up &amp;&amp; vagrant ssh
vagrant@precise64:~$ node --version &amp;&amp; npm --version
vagrant@precise64:~$ exit
$ vagrant destroy -f
</pre>
</div>

<p>
You now have a virtual box running Ubuntu and with git and node.js installed.
</p>
</div>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> Provisioning with Puppet</h3>
<div class="outline-text-3" id="text-5-2">
</div><div id="outline-container-sec-5-2-1" class="outline-4">
<h4 id="sec-5-2-1"><span class="section-number-4">5.2.1</span> Prerequisites</h4>
<div class="outline-text-4" id="text-5-2-1">
<ul class="org-ul">
<li>You have installed and tested VirtualBox and Vagrant
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-2-2" class="outline-4">
<h4 id="sec-5-2-2"><span class="section-number-4">5.2.2</span> Tasks</h4>
<div class="outline-text-4" id="text-5-2-2">
<ul class="org-ul">
<li>Convert from Vagrant Provisioning to Puppet
<ul class="org-ul">
<li>Remove your previous provisioning using Vagrant and the ~"shell"~ method from your <code>Vagrantfile</code>.
</li>
</ul>
</li>

<li>Create a file <code>&lt;project_root&gt;/manifests/default.pp</code> and set it up to do the following:
<ul class="org-ul">
<li>execute <code>apt-get update</code>
</li>
<li>install <code>curl</code>
</li>
<li>install <code>nodejs</code>

<p>
Please note that you first need to execute the following line in order to install the correct version of node.js:
</p>

<p>
<code>curl -sL https://deb.nodesource.com/setup_4.x | sudo -E bash -</code>
</p>
</li>
</ul>
</li>
</ul>



<ul class="org-ul">
<li>Test: Start up your box and execute the following:
</li>
</ul>

<div class="org-src-container">

<pre class="src src-bash">vagrant ssh -c "node --version"
</pre>
</div>

<p>
The version reported should <i>at least</i> be <code>v4.5.0</code>. If your version is <code>v0.6.12</code> (or similar) you have not executed the <code>curl</code> command above properly.
</p>
</div>
</div>

<div id="outline-container-sec-5-2-3" class="outline-4">
<h4 id="sec-5-2-3"><span class="section-number-4">5.2.3</span> Cleanup</h4>
<div class="outline-text-4" id="text-5-2-3">
<p>
Don&rsquo;t forget to run <code>vagrant destroy -f</code> to clean up your box once you are done.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> Update Sprint Test Plan</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Go through the user stories for this sprint and make sure you have a clear understanding of how to solve each of them.
</p>

<p>
Revisit and update your risks and contingencies section.
</p>

<p>
Add and/or revise the following items to your glossary:
</p>
<ul class="org-ul">
<li>Provisioning
</li>
<li>Deployment
</li>
<li>Production Server
</li>
<li>Provisioning Tools (Also: Orchestration Tools or Configuration Management Tools)
</li>
</ul>

<p>
Make sure you understand what each item is, and how to use them either in isolation or together with the other concepts.    
</p>
</div>
</div>
<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> Update Course Backlog</h3>
<div class="outline-text-3" id="text-5-4">
<ul class="org-ul">
<li>How can you integrate this into your development workflow?
<ul class="org-ul">
<li>How will you build your project on this platform?
</li>
<li>How will you test your project on this platform?
</li>
</ul>
</li>
<li>It takes some time to re-install node.js every time you bring this VM up. Can you speed this up in some way?
</li>
<li>What if you need more machines?

<p>
Where do you go from here? Are there any questions that you want answered? Add them, along with a brief strategy for how to find an answer.   
</p>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Sprint Acceptance Tests</h2>
<div class="outline-text-2" id="text-6">
<p>
You are done with this sprint when you have:
</p>
<ul class="org-ul">
<li>An understanding of what provisioning is, and the need for it.
</li>
<li>A shallow understanding of some of the more common provisioning tools.
</li>
<li>Provisioned a Vagrant box using the built-in mechanisms to install (at least) curl, git, and node.js.
</li>
<li>Provisioned a Vagrant box using Puppet to install (at least) curl and node.js
</li>
</ul>

<p>
You may also have:
</p>
<ul class="org-ul">
<li>Updated your Course Backlog
</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Mikael Svahnberg</p>
<p class="email">Email: <a href="mailto:Mikael.Svahnberg@bth.se">Mikael.Svahnberg@bth.se</a></p>
<p class="date">Created: 2017-05-31 Wed 08:12</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
